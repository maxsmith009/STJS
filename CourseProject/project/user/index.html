<!DOCTYPE html>
<html>
<head>
    <title>Cars</title>
    <meta charset="utf-8">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <script src="mainPage.js"></script>
    <script src="CarView.js"></script>

    <style type="text/css">
        body{  margin: 70px;}

        table {cursor: pointer}
        button{cursor: pointer;
            margin:10px}
        [type=button]{cursor: pointer}
    </style>

</head>
<body>

<h2>ПРОДАЖА МАШИН</h2>

<input type=button value='На главную' onclick='SwitchToMainPage()'>

<div  id='IPage' align="center">

</div>

<script>var form=$('#IPage');</script>

<script>

    window.onhashchange=SwitchToStateFromURLHash;

    var SPAStateH={};

    function SwitchToStateFromURLHash()
    {
        var URLHash=window.location.hash;
        var StateStr=URLHash.substr(1);

        if ( StateStr!="" )
        {
            var PartsA=StateStr.split("/")
            SPAStateH={ pagename: PartsA[0] };
            if ( SPAStateH.pagename=='CarIDScreen' )
                SPAStateH.carid=PartsA[1];
        }
        else
            SPAStateH={pagename:'Main'};


        var PageHTML="";
        switch ( SPAStateH.pagename )
        {
            case 'Main':
                form.empty();
                createSearchBar(form);
                createCarGrid(form);
                break;
            case 'Photo':
                form.empty();
                var PhotoH=PhotosH[SPAStateH.photoid];
                PageHTML+="<h3>Фото</h3>";
                PageHTML+="<img src='"+PhotoH.image+"'>";
                PageHTML+="<p><i>"+PhotoH.comment+"</i></p>";
                break;
            case 'CarsScreen':
                form.empty();

                break;
            case 'CarIDScreen':
                form.empty();
                createCarView(SPAStateH.carid);
                break;
        }

    }

    function SwitchToState(NewStateH)
    {
        var StateStr=NewStateH.pagename;
        if ( NewStateH.pagename=='CarIDScreen' )
            StateStr+="/"+NewStateH.carid;
        location.hash=StateStr;
    }

    function SwitchToMainPage()
    {   SwitchToState( { pagename:'Main' });

    }

    function SwitchToCarsPage(array)
    {
        SwitchToState( { pagename:'CarsScreen',array:array } );
    }

    function SwitchToCarIDPage(CarId)
    {
        SwitchToState( { pagename:'CarIDScreen',carid:CarId } );
    }

    SwitchToStateFromURLHash();

</script>

</body>
</html>